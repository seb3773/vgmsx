<!doctypehtml><html lang=en-us><head><meta charset=utf-8><meta content="text/html; charset=utf-8"http-equiv=Content-Type><title>vgMSX WebAssembly</title><link href=https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"rel=stylesheet><style>body{background-color:#1a1a2e;color:#fff;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;margin:0;padding:20px;display:flex;flex-direction:column;align-items:center}h1{color:#fff;background-color:#000;padding:10px 20px;margin-bottom:20px;font-family:'Press Start 2P',cursive;font-size:20px;text-transform:uppercase;border:2px solid #333;box-shadow:4px 4px 0 #333}#controls{margin-bottom:20px;display:flex;gap:15px;align-items:center;justify-content:center;width:100%}#fileInput{display:none}.btn{padding:12px 24px;background-color:#3636d8;color:#fff;border:2px solid #fff;border-radius:0;cursor:pointer;font-family:'Press Start 2P',cursive;font-size:10px;text-transform:uppercase;box-shadow:4px 4px 0 #000;transition:transform .1s}.btn:hover{transform:translate(2px,2px);box-shadow:2px 2px 0 #000}.btn:active{transform:translate(4px,4px);box-shadow:none}.btn:disabled{opacity:.5;cursor:not-allowed}#status{color:#a0a0a0;font-family:'Courier New',monospace;font-size:14px;font-weight:700}#terminal-container{display:inline-block;border:10px solid #000;border-radius:4px;background-color:#000;box-shadow:0 10px 30px rgba(0,0,0,.5);padding:0}#progress{height:6px;width:200px;border-radius:0;border:1px solid #fff}#progress::-webkit-progress-bar{background:#000}#progress::-webkit-progress-value{background:#e94560}</style></head><body><h1>vgMSX Player (WASM)</h1><div id=controls><button class=btn disabled id=loadBtn onclick='document.getElementById("fileInput").click()'>LOAD VGM FILE/ARCHIVE</button> <input accept=.vgm,.vgz,.zip id=fileInput onchange=loadFile() type=file> <span id=status>Loading...</span><progress hidden id=progress max=100 value=0></progress></div><div id=terminal-container></div><script src=https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js></script><script>var statusElement=document.getElementById("status"),progressElement=document.getElementById("progress"),loadBtn=document.getElementById("loadBtn"),moduleReady=!1,term=new Terminal({cols:69,rows:24,theme:{background:"#000000",foreground:"#cccccc",cursor:"#e94560",cursorAccent:"#e94560",black:"#000000",red:"#e94560"},fontFamily:'"Fira Code", "Cascadia Code", Consolas, monospace',fontSize:16,lineHeight:1.1,cursorBlink:!0,allowTransparency:!1});term.open(document.getElementById("terminal-container")),term.onKey((e=>{let t=0;switch(e.domEvent.key){case"Escape":t=27;break;case" ":t=32;break;case"Enter":t=10;break;case"ArrowUp":t=4097;break;case"ArrowDown":t=4098;break;case"ArrowLeft":t=4099;break;case"ArrowRight":t=4100}t&&moduleReady&&Module.ccall("WASM_HandleKey",null,["number"],[t])}));var Module={preRun:[],postRun:[function(){moduleReady=!0,loadBtn.disabled=!1,Module.setStatus("Ready."),term.writeln("[33mLoad a VGM or ZIP file to start.[0m")}],print:function(e){console.log(e),term.writeln(e)},printErr:function(e){console.error(e),term.writeln("[31m"+e+"[0m")},setStatus:function(e){if(Module.setStatus.last||(Module.setStatus.last={time:Date.now(),text:""}),e!==Module.setStatus.last.text){var t=e.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/),n=Date.now();t&&n-Module.setStatus.last.time<30||(Module.setStatus.last.time=n,Module.setStatus.last.text=e,t?(e=t[1],progressElement.value=100*parseInt(t[2]),progressElement.max=100*parseInt(t[4]),progressElement.hidden=!1):(progressElement.value=null,progressElement.max=null,progressElement.hidden=!0),statusElement.innerHTML=e)}},totalDependencies:0,monitorRunDependencies:function(e){this.totalDependencies=Math.max(this.totalDependencies,e),Module.setStatus(e?"Preparing... ("+(this.totalDependencies-e)+"/"+this.totalDependencies+")":"All downloads complete.")}};function loadFile(){if(moduleReady){var e=document.getElementById("fileInput");if(e.files&&e.files[0]){var t=e.files[0];Module.setStatus("Loading file..."),term.clear();var n=t.name.split(".").pop().toLowerCase(),r=new FileReader;"zip"===n?(r.onload=function(e){var t=e.target.result;JSZip.loadAsync(t).then((function(e){var t="/playlist";try{let e=Module.FS.readdir(t);for(let n=0;n<e.length;n++)"."!==e[n]&&".."!==e[n]&&Module.FS.unlink(t+"/"+e[n])}catch(e){try{Module.FS.mkdir(t)}catch(e){}}var n=[],r=0;e.forEach((function(e,l){if(!l.dir){var o=l.name.toLowerCase();(o.endsWith(".vgm")||o.endsWith(".vgz"))&&n.push(l.async("uint8array").then((function(e){var n=l.name.replace(/\\/g,"/").split("/").pop();Module.FS.writeFile(t+"/"+n,e),r++})))}})),Promise.all(n).then((function(){term.writeln("[32mExtracted "+r+" files to playlist.[0m"),Module.ccall("WASM_LoadFile",null,["string"],[t]),Module.setStatus("Playing Playlist"),term.focus()}))}),(function(e){Module.setStatus("Error reading ZIP"),term.writeln("[31mError reading ZIP file[0m")}))},r.readAsArrayBuffer(t)):(r.onload=function(e){var n=new Uint8Array(e.target.result),r="/"+t.name;Module.FS.writeFile(r,n),term.writeln("[32mFile loaded: "+t.name+" ("+n.length+" bytes)[0m"),Module.ccall("WASM_LoadFile",null,["string"],[r]),Module.setStatus("Playing: "+t.name),term.focus()},r.onerror=function(){Module.setStatus("Error reading file"),term.writeln("[31mError reading file[0m")},r.readAsArrayBuffer(t))}}else alert("Module not ready yet.")}Module.setStatus("Downloading..."),window.onerror=function(e){Module.setStatus("Exception thrown, see console"),console.error(e)}</script><script src=vgmsx.js async></script></body></html>